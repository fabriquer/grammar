<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<title>The Fabrique build language</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #8f5902; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { color: #a40000; border: 1px solid #ef2929 } /* Error */
.listingblock .pygments .tok-g { color: #000000 } /* Generic */
.listingblock .pygments .tok-k { color: #204a87; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-l { color: #000000 } /* Literal */
.listingblock .pygments .tok-n { color: #000000 } /* Name */
.listingblock .pygments .tok-o { color: #ce5c00; font-weight: bold } /* Operator */
.listingblock .pygments .tok-x { color: #000000 } /* Other */
.listingblock .pygments .tok-p { color: #000000; font-weight: bold } /* Punctuation */
.listingblock .pygments .tok-ch { color: #8f5902; font-style: italic } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #8f5902; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #8f5902; font-style: italic } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #8f5902; font-style: italic } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #8f5902; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #8f5902; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #a40000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { color: #000000; font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #ef2929 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #000000; font-style: italic } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #8f5902 } /* Generic.Prompt */
.listingblock .pygments .tok-gs { color: #000000; font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #a40000; font-weight: bold } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #204a87; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #204a87; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #204a87; font-weight: bold } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #204a87; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #204a87; font-weight: bold } /* Keyword.Type */
.listingblock .pygments .tok-ld { color: #000000 } /* Literal.Date */
.listingblock .pygments .tok-m { color: #0000cf; font-weight: bold } /* Literal.Number */
.listingblock .pygments .tok-s { color: #4e9a06 } /* Literal.String */
.listingblock .pygments .tok-na { color: #c4a000 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #204a87 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #000000 } /* Name.Class */
.listingblock .pygments .tok-no { color: #000000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #5c35cc; font-weight: bold } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #ce5c00 } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #cc0000; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #000000 } /* Name.Function */
.listingblock .pygments .tok-nl { color: #f57900 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #000000 } /* Name.Namespace */
.listingblock .pygments .tok-nx { color: #000000 } /* Name.Other */
.listingblock .pygments .tok-py { color: #000000 } /* Name.Property */
.listingblock .pygments .tok-nt { color: #204a87; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #000000 } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #204a87; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #f8f8f8; text-decoration: underline } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #0000cf; font-weight: bold } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #0000cf; font-weight: bold } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #0000cf; font-weight: bold } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #0000cf; font-weight: bold } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #0000cf; font-weight: bold } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #4e9a06 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #4e9a06 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #4e9a06 } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #4e9a06 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #8f5902; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #4e9a06 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #4e9a06 } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #4e9a06 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #4e9a06 } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #4e9a06 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #4e9a06 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #4e9a06 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #4e9a06 } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #3465a4 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #000000 } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #000000 } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #000000 } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #000000 } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #000000 } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #0000cf; font-weight: bold } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-right">
<div id="header">
<h1>The Fabrique build language</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_motivation">Motivation</a></li>
<li><a href="#_grammatical_elements">Grammatical elements</a>
<ul class="sectlevel2">
<li><a href="#_comments_and_whitespace">Comments and whitespace</a></li>
<li><a href="#_values">Values</a></li>
<li><a href="#_identifiers">Identifiers</a></li>
<li><a href="#_expressions">Expressions</a>
<ul class="sectlevel3">
<li><a href="#_build_actions">Build actions</a></li>
<li><a href="#_calls">Calls</a></li>
<li><a href="#_compound_expressions">Compound expressions</a></li>
<li><a href="#_conditionals">Conditionals</a></li>
<li><a href="#_field_references">Field references</a></li>
<li><a href="#_files">Files</a></li>
<li><a href="#_foreach">Foreach</a></li>
<li><a href="#_functions">Functions</a></li>
<li><a href="#_literals">Literals</a></li>
<li><a href="#_lists">Lists</a></li>
<li><a href="#_parenthetical_expressions">Parenthetical expressions</a></li>
<li><a href="#_type_declarations">Type declarations</a></li>
</ul>
</li>
<li><a href="#_todo">TODO</a>
<ul class="sectlevel3">
<li><a href="#_binary_operators">Binary operators</a></li>
<li><a href="#_field_queries">Field queries</a></li>
<li><a href="#_records">Records</a></li>
<li><a href="#_terms">Terms</a></li>
<li><a href="#_types">Types</a></li>
<li><a href="#_unary_operations">Unary operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_motivation">Motivation</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_grammatical_elements">Grammatical elements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_comments_and_whitespace">Comments and whitespace</h3>
<div class="paragraph">
<p>Comments and whitespace look much like they do in shell scripts.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># Fabrique uses single-line comments that start with a &#39;#&#39; character</span>

<span class="tok-c1"># Here&#39;s another comment:</span>
<span class="tok-nv">sources</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nb">files</span><span class="tok-p">(</span><span class="tok-nv">a</span><span class="tok-o">.</span><span class="tok-nv">c</span><span class="tok-w"> </span><span class="tok-nv">b</span><span class="tok-o">.</span><span class="tok-nv">c</span><span class="tok-p">);</span><span class="tok-w">     </span><span class="tok-c1"># our source files</span>

<span class="tok-c1">#</span>
<span class="tok-c1"># Begin/end multiline comments are not supported: just use multiple single-line</span>
<span class="tok-c1"># comments together in a row.</span>
<span class="tok-c1">#</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Single-line comments start with a <code>#</code> character.
There are no multi-line comments.
Comments are currently ignored completely.
We may add semantics to comments in the future (a la Doxygen), but we
haven&#8217;t yet.</p>
</div>
<div class="paragraph">
<p>Whitespace in Fabrique is not significant (like, e.g., Python):
spaces, tabs and newlines are all ignored.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">Comment</span><span class="tok-w">		</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;#&#39;</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-p">[</span><span class="tok-x">\r\n</span><span class="tok-p">]</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">skip</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">WS</span><span class="tok-w">		</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-x"> \t\r\n</span><span class="tok-p">]</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">skip</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_values">Values</h3>
<div class="paragraph">
<p>A Fabrique file is made up of [optionally-]named values.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nv">source_files</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nb">files</span><span class="tok-p">(</span><span class="tok-nv">a</span><span class="tok-o">.</span><span class="tok-nv">cc</span><span class="tok-w"> </span><span class="tok-nv">b</span><span class="tok-o">.</span><span class="tok-nv">cc</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-nv">count</span><span class="tok-p">:</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">source_files</span><span class="tok-o">.</span><span class="tok-nv">length</span><span class="tok-p">();</span><span class="tok-w"></span>

<span class="tok-nv">object_files</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">compile</span><span class="tok-p">(</span><span class="tok-nv">source_files</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-nv">executable</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">link</span><span class="tok-p">(</span><span class="tok-nv">object_files</span><span class="tok-p">);</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">file</span><span class="tok-w">		</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">values</span><span class="tok-o">+=</span><span class="tok-nv">value</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-no">EOF</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">value</span><span class="tok-w">		</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">name</span><span class="tok-o">=</span><span class="tok-no">Identifier</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s">&#39;=&#39;</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-s">&#39;;&#39;</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Semantics</div>
<p>Most values bind a name (which must be a <a href="#_identifiers">legal identifier</a>)
to the result of evaluating an <a href="#_expressions">expression</a>.
It&#8217;s also possible to simply use an expression without naming it, but that&#8217;s
only really useful for expressions that cause side effects (e.g., declaring
a build step without giving it an explicit name).
Values are like variables in many languages, but with a few key aspects
from functional programming:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>values are immutable, so there is no distinction between declaration and
assignment;</p>
</li>
<li>
<p>a value&#8217;s type may be specified explicitly or <em>inferred</em> by Fabrique:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>all expressions (on the RHS) evaluate to a value with a type, so that
type can be found when the build is configured;</p>
</li>
<li>
<p>if an explicit type is given, Fabrique will check that the expression
evaluates to a <a href="#_subtypes">subtype of the explicit type</a>;</p>
</li>
</ol>
</div>
</li>
<li>
<p>value names may not be redefined within a scope;</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Otherwise, values share some characteristics with statements in other
curly-brace languages like C and Java:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>values are terminated by a semicolon;</p>
</li>
<li>
<p>if the value has a name, it must be followed by an equals sign.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_identifiers">Identifiers</h3>
<div class="paragraph">
<p>Identifiers looks like those in many programming languages.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># This is a sensible name:</span>
<span class="tok-nv">a_valid_identifier</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c1"># This is a less-sensible but still-legal name:</span>
<span class="tok-nv">another_identifier_that_is_valid_even_if_it_is_2_long_4_G00D_STYLE</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c1"># This is not an identifier:</span>
<span class="tok-err">1</span><span class="tok-nv">badname</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Fabrique identifiers currently only use characters from the ASCII character
set.
Careful thought will be required in the future about adding support for other
characters.
Identifiers must start with a letter and then may continue with letters,
numbers and underscores.
It is conventional (but not mandated) to use underscore-separated
lower-case names.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">Identifier</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-x">a-zA-Z</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-x">a-zA-Z0-9_</span><span class="tok-p">]</span><span class="tok-o">*</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_expressions">Expressions</h3>
<div class="paragraph">
<p>Almost everything in Fabrique is an expression that can be evaluated.</p>
</div>
<div class="sect3">
<h4 id="_build_actions">Build actions</h4>
<div class="paragraph">
<p>At the heart of a Fabrique build description is a set of <em>build actions</em>.
Each build action represents a step that transforms
input <a href="#_files">file(s)</a> to output <a href="#_files">file(s)</a>.
Common build actions include compiling source files, linking libraries and
executables and generating code (e.g., with <code>rpcgen</code> and <code>yacc</code>).
Actions defined in Fabrique source files execute shell commands with string
substitution (e.g., <code>'${cc} ${cflags} -c ${src} -o ${obj}'</code>); these commands
are executed at build time (rather than compile time).</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span>
<span class="tok-nv">cc</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nb">action</span><span class="tok-p">(</span><span class="tok-s1">&#39;</span><span class="tok-dl">${</span><span class="tok-si">cc}</span><span class="tok-s1"> </span><span class="tok-dl">${</span><span class="tok-si">flags}</span><span class="tok-s1"> -c </span><span class="tok-dl">${</span><span class="tok-si">src}</span><span class="tok-s1"> -o </span><span class="tok-dl">${</span><span class="tok-si">obj}</span><span class="tok-s1">&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">description</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-s1">&#39;Compiling </span><span class="tok-dl">${</span><span class="tok-si">src}</span><span class="tok-s1">&#39;</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">&lt;</span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">src</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nb">file</span><span class="tok-p">[</span><span class="tok-kp">in</span><span class="tok-p">],</span><span class="tok-w"> </span><span class="tok-nv">obj</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nb">file</span><span class="tok-p">[</span><span class="tok-kp">out</span><span class="tok-p">],</span><span class="tok-w"> </span><span class="tok-nv">flags</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-kt">string</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[]);</span><span class="tok-w"></span>

<span class="tok-nv">obj</span><span class="tok-p">:</span><span class="tok-nb">file</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">cc</span><span class="tok-p">(</span><span class="tok-nv">src_file</span><span class="tok-p">);</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An action contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a command to run,</p>
</li>
<li>
<p>[optional] arguments to the action itself (e.g., <code>description</code>) and</p>
</li>
<li>
<p>parameters that invocations of the action need to provide.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Actions have a <a href="#_function_types">function type</a>,
e.g., <code>(file[in])&#8658;file[out]</code>, and can be <a href="#_calls">called</a> like functions.</p>
</div>
<div class="paragraph">
<p>The command to execute can include <code>${varname}</code>-style substitution patterns.
These substitutions can capture values from the parameters required by the
action, or else from the arguments provided to the action, or if not found
there, captured from the script that the action is defined in
(useful for selecting tools, e.g., <code>${cc}</code>).</p>
</div>
<div class="paragraph">
<p>Arguments to the action (after the command) must be keyword arguments
(see <a href="#_calls">Calls</a> for more details).
A <code>description</code> argument can be used to customize build log output
(e.g., <code>'Compiling ${src}'</code>).
Other arguments are made available for substitution into the command.</p>
</div>
<div class="paragraph">
<p>Action parameters can be of any defined <a href="#_types">type</a>.
Parameters of <code>file</code> type should specify whether the file in question is an
input to the rule (<code>file[in]</code>) or an output (<code>file[out]</code>).
This is critical for calculating the graph of build dependencies;
it is an error to omit the <code>in</code> or <code>out</code> tag.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">buildAction</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;action&#39;</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">command</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"></span>
<span class="tok-w">		</span><span class="tok-o">(</span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">keywordArguments</span><span class="tok-o">)?</span><span class="tok-w"></span>
<span class="tok-w">		</span><span class="tok-o">(</span><span class="tok-s">&#39;&lt;-&#39;</span><span class="tok-w"> </span><span class="tok-nv">parameters</span><span class="tok-o">)?</span><span class="tok-w"></span>
<span class="tok-w">		</span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_calls">Calls</h4>
<div class="paragraph">
<p>Values of function type (including both <a href="#_build_actions">build actions</a>
and <a href="#_functions">functions</a>) can be <em>called</em> using a syntax that looks like
a lot of languages: with comma-separated arguments inside of parentheses.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nv">noArguments</span><span class="tok-p">();</span><span class="tok-w"></span>
<span class="tok-nv">positionalArguments</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-kc">true</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-nv">keywordArguments</span><span class="tok-p">(</span><span class="tok-nv">what</span><span class="tok-kd">=</span><span class="tok-s1">&#39;hello&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">who</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-s1">&#39;world&#39;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-nv">mixedArguments</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">x</span><span class="tok-kd">=</span><span class="tok-mi">3</span><span class="tok-p">);</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Arguments may be <em>positional</em> (parameter name unspecified) or
<em>keyword</em> (parameter name specified).
Positional arguments, if present, must come first — otherwise it would be
difficult to tell which parameter you intend each argument to be passed to.
It is permissible to use an extra comma at the end of the argument list;
this can help reduce the sizes of diffs when parameters and arguments are
added or removed.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Anything with a function type can be called</span><span class="tok-w"></span>
<span class="tok-nl">call</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">term</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">arguments</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">arguments</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">positionalArguments</span><span class="tok-w"> </span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">keywordArguments</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">positionalArguments</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">keywordArguments</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">keywordArgument</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">Identifier</span><span class="tok-w"> </span><span class="tok-s">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">keywordArguments</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">args</span><span class="tok-o">+=</span><span class="tok-nv">keywordArgument</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">args</span><span class="tok-o">+=</span><span class="tok-nv">keywordArgument</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s">&#39;,&#39;</span><span class="tok-o">?)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">positionalArguments</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s">&#39;,&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compound_expressions">Compound expressions</h4>
<div class="paragraph">
<p>A compound expression is a braced list of values followed by an expression.
The values describe intermediate state that can be used by the final
"result" expression.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">src</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nb">file</span><span class="tok-p">(</span><span class="tok-nv">basename</span><span class="tok-w"> + </span><span class="tok-s1">&#39;.c&#39;</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">obj</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">compile</span><span class="tok-p">(</span><span class="tok-nv">src</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">binary</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">link</span><span class="tok-p">(</span><span class="tok-nv">obj</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-w">	</span><span class="tok-nv">binary</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Compound expressions can help clarify the meaning of expressions like
<a href="#_conditionals">conditionals</a> by adding braces.
They also constrain the scope of intermediate variables, which can also help
with clarity of expression.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Zero or more value definitions and a result</span><span class="tok-w"></span>
<span class="tok-nl">compoundExpr</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">values</span><span class="tok-o">+=</span><span class="tok-nv">value</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-nv">result</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-s">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conditionals">Conditionals</h4>
<div class="paragraph">
<p>Rather than an <code>if</code> statement, Fabrique has a conditional <code>if</code>
<em>expression</em>.
This functions like the ternary operator in C, but is hopefully a bit more
readable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nv">like_an_if_statement</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">-</span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-p">};</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Unlike other popular languages, the parentheses around the condition
(making it a <a href="#_parenthetical_expressions">parenthetical expression</a>)
and the braces around the "then" and "else" clauses
(making them <a href="#_compound_expressions">compound expressions</a>)
are entirely optional:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nv">more_succinct</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-w"> </span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-p">-</span><span class="tok-nv">y</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Whether or not to use the extra punctuation is a question of clarity and style.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">conditional</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;if&#39;</span><span class="tok-w"></span>
<span class="tok-w">	  </span><span class="tok-nv">condition</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"></span>
<span class="tok-w">	  </span><span class="tok-nv">thenClause</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"></span>
<span class="tok-w">	  </span><span class="tok-s">&#39;else&#39;</span><span class="tok-w"></span>
<span class="tok-w">	  </span><span class="tok-nv">elseClause</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_field_references">Field references</h4>
<div class="paragraph">
<p><a href="#_records">Records</a> contain fields, which are accessed using the dot (<code>.</code>) operator.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># Access a single field:</span>
<span class="tok-nv">simple</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">foo</span><span class="tok-o">.</span><span class="tok-nv">bar</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c1"># Access a field within a field (within a field, within a field, ...):</span>
<span class="tok-nv">nested</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">foo</span><span class="tok-o">.</span><span class="tok-nv">bar</span><span class="tok-o">.</span><span class="tok-nv">baz</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c1"># Slightly more complicated things:</span>
<span class="tok-nv">complex</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-nv">something</span><span class="tok-w"> </span><span class="tok-nv">foo</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-nv">bar</span><span class="tok-p">)</span><span class="tok-o">.</span><span class="tok-nv">baz</span><span class="tok-o">.</span><span class="tok-nv">wibble</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nv">veryComplex</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">x</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-kt">record</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">foo</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-mi">42</span><span class="tok-w"> </span><span class="tok-p">};</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-kt">record</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">bar</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">x</span><span class="tok-w"> </span><span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-w">	</span><span class="tok-nv">y</span><span class="tok-w"></span>
<span class="tok-p">}</span><span class="tok-o">.</span><span class="tok-nv">bar</span><span class="tok-o">.</span><span class="tok-nv">foo</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The base of a field reference (the record containing the fields) must be a
<a href="#_terms">term</a>, but that includes compound expressions and
parenthetical expressions.
Using one of those constructs, you can construct expressions that are quite
sophisticated.
However, good style would suggest that you keep visual complexity under control.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Access a field within a record</span><span class="tok-w"></span>
<span class="tok-nl">fieldReference</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">term</span><span class="tok-w"> </span><span class="tok-s">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-no">Identifier</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">fieldReference</span><span class="tok-w"> </span><span class="tok-s">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-no">Identifier</span><span class="tok-w">     </span><span class="tok-c">// explicitly left-recursive</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_files">Files</h4>
<div class="paragraph">
<p>Files are the primary artifacts of almost any build.
Fabrique provides two ways to describe files: individually using the <code>file</code>
builtin or collectively using the <code>files</code> construct.</p>
</div>
<div class="sect4">
<h5 id="_file_declarations">File declarations</h5>
<div class="paragraph">
<p>Individual files can be described with the <code>file</code> builtin.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nb">file</span><span class="tok-p">(</span><span class="tok-s1">&#39;foo.c&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">cflags</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-s1">&#39;-D&#39;</span><span class="tok-w"> </span><span class="tok-s1">&#39;FOO&#39;</span><span class="tok-w"> </span><span class="tok-p">]);</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This builtin looks like a regular function, but its name is a reserved word
in the language and it requires that the first (positional) argument be a
string containing a filename (usually relative to the directory containing the
current Fabrique file).
Additional arguments are stored as properties of the file; these properties
can be accessed by <a href="#_build_actions">build actions</a> and <a href="#_functions">functions</a>
that accept file arguments.</p>
</div>
<div class="paragraph">
<div class="title">Grammar</div>
<p>Grammatically, a file declaration looks like <a href="#_calls">any other call</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_file_lists">File lists</h5>
<div class="paragraph">
<p>When describing lots of files, it can be inconvenient to wrap each of them in
a <code>file</code> declaration.
Fabrique also provides a dedicated syntax for describing lots of files:
the <em>file list</em>.
A file list is wrapped by <code>files()</code> like a call, but internally its syntax
permits the use of raw filenames.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nb">files</span><span class="tok-p">(</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">foo</span><span class="tok-o">.</span><span class="tok-nv">c</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">bar</span><span class="tok-o">.</span><span class="tok-nv">c</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">,</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">cflags</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-s1">&#39;-Wall&#39;</span><span class="tok-p">],</span><span class="tok-w"> </span><span class="tok-nv">arg2</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-mi">42</span><span class="tok-w"></span>
<span class="tok-p">)</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A file list contains a sequence of raw filenames, optionally followed by some
keyword arguments (see <a href="#_calls">Calls</a> for details).
Just like file declarations, the keyword arguments are turned into fields
attached to the file list (and visible as fields each file in the list when
the list is iterated over with a <a href="#_foreach">foreach expression</a>).
Arguments to embedded file declarations can override arguments passed to the
file list (e.g., <code>cflags</code> in the example above).</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Some number of files with common properties</span><span class="tok-w"></span>
<span class="tok-nl">fileList</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">FileListStart</span><span class="tok-w"> </span><span class="tok-no">FilenameLiteral</span><span class="tok-o">*</span><span class="tok-w"></span>
<span class="tok-w">	  </span><span class="tok-o">(</span><span class="tok-no">FileListEnd</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-no">FileListArgs</span><span class="tok-w"> </span><span class="tok-nv">keywordArguments</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-o">))</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-c">// With lexer rules:</span><span class="tok-w"></span>
<span class="tok-nl">FileListStart</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;files(&#39;</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">pushMode</span><span class="tok-o">(</span><span class="tok-no">FileList</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">   </span><span class="tok-c">// enter &quot;file list&quot; mode</span><span class="tok-w"></span>
<span class="tok-nl">FileListEnd</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">popMode</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">FileListArgs</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">popMode</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">FilenameLiteral</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-x">A-Za-z0-9_./</span><span class="tok-p">]</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">FileListWS</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-x"> \t\r\n</span><span class="tok-p">]</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">skip</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_foreach">Foreach</h4>
<div class="paragraph">
<p>A foreach loop transforms one sequence into another.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># A somewhat verbose way to use foreach, a bit like a conventional for loop:</span>
<span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">foreach</span><span class="tok-w"> </span><span class="tok-nv">x</span><span class="tok-w"> </span><span class="tok-p">&lt;-</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-p">]</span><span class="tok-w"></span>
<span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">x</span><span class="tok-w"> + </span><span class="tok-mi">1</span><span class="tok-w"></span>
<span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-c1"># Equivalently, a shorter way of expressing the same thing:</span>
<span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">foreach</span><span class="tok-w"> </span><span class="tok-nv">x</span><span class="tok-w"> </span><span class="tok-p">&lt;-</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-nv">x</span><span class="tok-w"> + </span><span class="tok-mi">1</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Unlike most general-purpose computation languages, Fabrique doesn&#8217;t have
statements, so it doesn&#8217;t have a conventional looping primitive.
What it does have is the ability to transform one sequence of things
(e.g., source files) into a sequence of related things (e.g., object files).
This is much like applying a mapping operation to an iterator, but it&#8217;s spelled
<code>foreach</code> to be a bit more accessible.</p>
</div>
<div class="paragraph">
<p>The <code>foreach</code> expression includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the keyword <code>foreach</code>,</p>
</li>
<li>
<p>the name of the loop variable,</p>
</li>
<li>
<p>the sequence to map from and</p>
</li>
<li>
<p>an expression representing the transformation of one sequence element.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The entire <code>foreach</code> expression evaluates to a sequence of new elements.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Transforms one sequence into another</span><span class="tok-w"></span>
<span class="tok-nl">foreach</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;foreach&#39;</span><span class="tok-w"> </span><span class="tok-no">Identifier</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-s">&#39;&lt;-&#39;</span><span class="tok-w"> </span><span class="tok-nv">src</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-nv">body</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_functions">Functions</h4>
<div class="paragraph">
<p>As a somewhat functional language, functions are pretty important to Fabrique!
They are, together with <a href="#_records">records</a>, the primary means of building up
higher-level abstractions (e.g., toolchains) from lower-level abstractions
(e.g., <a href="#_build_actions">build action</a> invocation).</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># These default flags will be visible in the `compile` function below</span>
<span class="tok-nv">default_flags</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-kt">record</span><span class="tok-w"></span>
<span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-nv">object</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-s1">&#39;-fPIC&#39;</span><span class="tok-w"> </span><span class="tok-p">];</span><span class="tok-w"></span>
<span class="tok-p">};</span><span class="tok-w"></span>

<span class="tok-nv">compile</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">function</span><span class="tok-p">(</span><span class="tok-nv">srcs</span><span class="tok-p">:</span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-nb">file</span><span class="tok-p">],</span><span class="tok-w"> </span><span class="tok-nv">common_flags</span><span class="tok-p">:</span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-kt">string</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[],</span><span class="tok-w"></span>
<span class="tok-w">                   </span><span class="tok-nv">deps</span><span class="tok-p">:</span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-nb">file</span><span class="tok-p">[</span><span class="tok-kp">in</span><span class="tok-p">]]</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[]):</span><span class="tok-w"> </span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-nb">file</span><span class="tok-p">]</span><span class="tok-w"></span>
<span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-k">foreach</span><span class="tok-w"> </span><span class="tok-nv">src</span><span class="tok-w"> </span><span class="tok-p">&lt;-</span><span class="tok-w"> </span><span class="tok-nv">srcs</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">{</span><span class="tok-w"></span>
<span class="tok-w">		</span><span class="tok-nv">obj</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">src</span><span class="tok-w"> + </span><span class="tok-s1">&#39;.o&#39;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-w">		</span><span class="tok-nv">flags</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">src</span><span class="tok-o">.</span><span class="tok-nv">cxxflags</span><span class="tok-w"> </span><span class="tok-err">?</span><span class="tok-w"> </span><span class="tok-nv">common_flags</span><span class="tok-p">)</span><span class="tok-w"> + </span><span class="tok-nv">default_flags</span><span class="tok-o">.</span><span class="tok-nv">object</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-w">		</span><span class="tok-nv">compile_one</span><span class="tok-p">(</span><span class="tok-nv">src</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">obj</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">flags</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">deps</span><span class="tok-p">);</span><span class="tok-w"></span>
<span class="tok-w">		</span><span class="tok-nv">obj</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">}</span><span class="tok-w"></span>
<span class="tok-p">};</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As in other languages, functions take parameters and return a value.
Parameters can have default arguments in case no arguments are passed to them
in the function <a href="#_calls">call</a>.</p>
</div>
<div class="paragraph">
<p>Fabrique functions are closures that capture values from the surrounding scope.
This can be useful for providing <a href="#Modules">module</a>-level defaults.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Transforms parameters into a result</span><span class="tok-w"></span>
<span class="tok-nl">function</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;function&#39;</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">parameters</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-o">)?</span><span class="tok-w"></span>
<span class="tok-w">	  </span><span class="tok-nv">body</span><span class="tok-o">=</span><span class="tok-nv">expression</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">parameters</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">parameter</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">parameter</span><span class="tok-o">)*)?</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">parameter</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">Identifier</span><span class="tok-w"> </span><span class="tok-s">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_literals">Literals</h4>
<div class="paragraph">
<p>Fabrique (currently) supports three literal types: boolean values,
integers and strings (single- or double-quoted).</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nv">p</span><span class="tok-p">:</span><span class="tok-kt">bool</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-kc">true</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nv">q</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-kc">false</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nv">integer</span><span class="tok-p">:</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-mi">42</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nv">single_quoted</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-s1">&#39;double quotes (&quot;) are OK&#39;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nv">double_quoted</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-s2">&quot;single quotes (&#39;) are OK&quot;</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nv">list_of_numbers</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-p">];</span><span class="tok-w"></span>
<span class="tok-nv">list_of_bools</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-kc">true</span><span class="tok-w"> </span><span class="tok-kc">false</span><span class="tok-w"> </span><span class="tok-p">];</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Boolean literals are spelled in all lower-case (<code>true</code> and <code>false</code>).
Integers are currently specified in a base-10 representation; future versions
of this grammar may also support binary, octal or hex literals.
Strings may be single- or double-quoted; there is not semantic distinction
between them, the two types exist purely for convenience of writing strings
that contain quote characters.
<strong>We do not yet support escape characters.</strong></p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// We support boolean, numeric and string literals</span><span class="tok-w"></span>
<span class="tok-nl">literal</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">BoolLiteral</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">IntLiteral</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">StringLiteral</span><span class="tok-w"></span>
<span class="tok-w">	</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nl">BoolLiteral</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;true&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s">&#39;false&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">IntLiteral</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-x">0-9</span><span class="tok-p">]</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nl">StringLiteral</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;\&#39;&#39;</span><span class="tok-w"> </span><span class="tok-o">.*?</span><span class="tok-w"> </span><span class="tok-s">&#39;\&#39;&#39;</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s">&#39;&quot;&#39;</span><span class="tok-w"> </span><span class="tok-o">.*?</span><span class="tok-w"> </span><span class="tok-s">&#39;&quot;&#39;</span><span class="tok-o">)</span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lists">Lists</h4>
<div class="paragraph">
<p>Lists are containers for like values and do not use comma separators.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-nv">x</span><span class="tok-p">:</span><span class="tok-kt">int</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-mi">42</span><span class="tok-p">;</span><span class="tok-w"></span>
<span class="tok-nv">y</span><span class="tok-p">:</span><span class="tok-nv">special_int</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">some_special_kind_of_int</span><span class="tok-p">();</span><span class="tok-w"></span>

<span class="tok-nv">l</span><span class="tok-p">:</span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-kt">int</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-w"> </span><span class="tok-nv">x</span><span class="tok-w"> </span><span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-p">];</span><span class="tok-w">   </span><span class="tok-c1"># the type of this is list[int]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The type of the list is taken to be "list of the supertype of all of the
list&#8217;s elements".</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-c">// Zero or more expressions of (some) like type</span><span class="tok-w"></span>
<span class="tok-nl">list</span><span class="tok-w">		</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">BracketOpen</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">values</span><span class="tok-o">+=</span><span class="tok-nv">expression</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-no">BracketClose</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parenthetical_expressions">Parenthetical expressions</h4>
<div class="paragraph">
<p>An expression enclosed in parentheses is treated as a <a href="#_terms"><em>term</em></a>
and can therefore appear in places that a more general expression expression
cannot.
It is also evaluated before subexpressions that are not inside of the
parentheses.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># Specifying an order of operations:</span>
<span class="tok-nv">x</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">p</span><span class="tok-w"> </span><span class="tok-ow">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">q</span><span class="tok-w"> </span><span class="tok-ow">or</span><span class="tok-w"> </span><span class="tok-nv">r</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-c1"># Choose which function we want to call:</span>
<span class="tok-nv">y</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-nv">useF</span><span class="tok-w"> </span><span class="tok-nv">f</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-nv">g</span><span class="tok-p">)(</span><span class="tok-nv">x</span><span class="tok-p">);</span><span class="tok-w"></span>

<span class="tok-c1"># Without parentheses, g(x) is evaluated before the if condition:</span>
<span class="tok-nv">bad</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">if</span><span class="tok-w"> </span><span class="tok-nv">useF</span><span class="tok-w"> </span><span class="tok-nv">f</span><span class="tok-w"> </span><span class="tok-k">else</span><span class="tok-w"> </span><span class="tok-nv">g</span><span class="tok-p">(</span><span class="tok-nv">x</span><span class="tok-p">);</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Just like every other language, Fabrique has an order of operations for its
operators, and parentheses can be used to override that order.
In the example above, the expression for <code>x</code> will only be true if <code>p</code> is true;
without parentheses, <code>r</code> alone would be sufficient to make <code>x</code> true.</p>
</div>
<div class="paragraph">
<p>Parentheses are also helpful when we want to use an expression inside of an
expression that only works with terms.
For example, a <a href="#_calls">call</a> or <a href="#_field_references">field reference</a>
requires its target (the function to call or the record to look in) to be
a term.
The example code above shows how we can use an expression like a
<a href="#_conditionals">conditional</a> to choose which function we want to call,
then use that conditional within parentheses to actually specifify the
call target.</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">parentheticalExpression</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-s">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_type_declarations">Type declarations</h4>
<div class="paragraph">
<p>Types can be declared using the keyword <code>type</code> followed by a normal
<a href="#_types">type annotation</a>.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="fabrique"><span></span><span class="tok-c1"># An empty record type:</span>
<span class="tok-nv">foo</span><span class="tok-p">:</span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-kt">record</span><span class="tok-p">[];</span><span class="tok-w"></span>

<span class="tok-c1"># A more interesting record type:</span>
<span class="tok-nv">bar</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-kt">record</span><span class="tok-p">[</span><span class="tok-nv">x</span><span class="tok-p">:</span><span class="tok-kt">int</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">y</span><span class="tok-p">:</span><span class="tok-kt">string</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nv">z</span><span class="tok-p">:</span><span class="tok-kt">record</span><span class="tok-p">[</span><span class="tok-nv">wibble</span><span class="tok-p">:</span><span class="tok-kt">int</span><span class="tok-p">]];</span><span class="tok-w"></span>

<span class="tok-c1"># A parameterized type:</span>
<span class="tok-nv">baz</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-kt">list</span><span class="tok-p">[</span><span class="tok-kt">string</span><span class="tok-p">];</span><span class="tok-w"></span>

<span class="tok-c1"># A function type:</span>
<span class="tok-nv">wibble</span><span class="tok-p">:</span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">baz</span><span class="tok-p">)-&gt;</span><span class="tok-kt">int</span><span class="tok-p">;</span><span class="tok-w"></span>

<span class="tok-nv">f</span><span class="tok-p">:</span><span class="tok-nv">wibble</span><span class="tok-w"> </span><span class="tok-kd">=</span><span class="tok-w"> </span><span class="tok-k">function</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">names</span><span class="tok-p">:</span><span class="tok-nv">baz</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-nv">names</span><span class="tok-o">.</span><span class="tok-nv">size</span><span class="tok-w"> </span><span class="tok-p">};</span><span class="tok-w"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Type declarations are like typedefs in other languages: they allow a new name
to be used for another (possibly complicated) type.
There is currently no support for parameterizing declared types
(e.g., <code>foo[int]</code>).</p>
</div>
<div class="listingblock">
<div class="title">Grammar</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr"><span></span><span class="tok-nl">typeDeclaration</span><span class="tok-w">	</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s">&#39;type&#39;</span><span class="tok-w"> </span><span class="tok-nv">type</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_todo">TODO</h3>
<div class="sect3">
<h4 id="_binary_operators">Binary operators</h4>

</div>
<div class="sect3">
<h4 id="_field_queries">Field queries</h4>

</div>
<div class="sect3">
<h4 id="_records">Records</h4>

</div>
<div class="sect3">
<h4 id="_terms">Terms</h4>

</div>
<div class="sect3">
<h4 id="_types">Types</h4>
<div class="sect4">
<h5 id="_simple_types">Simple types</h5>

</div>
<div class="sect4">
<h5 id="_parametric_types">Parametric types</h5>

</div>
<div class="sect4">
<h5 id="_record_types">Record types</h5>

</div>
<div class="sect4">
<h5 id="_function_types">Function types</h5>

</div>
<div class="sect4">
<h5 id="_subtypes">Subtypes</h5>

</div>
</div>
<div class="sect3">
<h4 id="_unary_operations">Unary operations</h4>

</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-09-22 15:48:22 NDT
</div>
</div>
</body>
</html>